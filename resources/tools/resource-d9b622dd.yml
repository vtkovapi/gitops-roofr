type: function
function:
  name: get_estimate
  strict: true
  description: |-
    Get an instant roofing estimate for a property. Also stores the lead in Roofr.

    Requires:
    - Valid addressId from resolve_address tool
    - Contact info (phone, name)
    - Property details (type, slope, timeline)

    Returns estimate ranges for different material options.
    For flat roofs or unsupported materials, estimate may not be available.
  parameters:
    type: object
    properties:
      slope:
        description: Roof slope/pitch as described by caller
        type: string
        enum:
          - flat
          - low
          - steep
          - moderate
        default: ""
      timeline:
        description: Project timeline urgency
        type: string
        enum:
          - urgent
          - soon
          - none
        default: ""
      addressUuid:
        description: The Roofr addressId obtained from resolve_address tool
        type: number
        default: ""
      contactName:
        description: Caller's name
        type: string
      shingleType:
        description: |-
          Preferred shingle/material type (e.g., "asphalt", "metal", "tile", "slate")
          Use "asphalt" if nothing is provided
        type: string
        enum:
          - asphalt
          - metal
          - tile
          - slate
        default: ""
      contactEmail:
        description: Caller's email address for sending estimate details (optional)
        type: string
      contactPhone:
        description: Caller's phone number for follow-up, must include + prefix (e.g., +15101234567 not 5101234567)
        type: string
        default: ""
      propertyType:
        description: Type of property
        type: string
        enum:
          - residential
          - commercial
      allowHomeownerSms:
        description: "Whether caller consented to receive SMS messages. "
        type: boolean
        default: ""
    required:
      - addressUuid
      - contactPhone
      - contactName
      - propertyType
messages:
  - type: request-start
    content: Let me pull up your estimate now. This will just take a moment.
    blocking: true
  - type: request-response-delayed
    content: Still calculating your estimate.
    timingMilliseconds: 10000
server:
  url: https://app-v2.roofr-staging.com/api/v1/voice-lead/vapi/webhook/03e5c715-5ea0-46a1-a69e-3f4a01f85eb5
  timeoutSeconds: 20
  credentialId: 2f6db611-ad08-4099-8bd8-74db37b0a07e
async: false
