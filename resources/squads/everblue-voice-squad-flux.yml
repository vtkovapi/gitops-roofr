members:
  - assistantId: everblue-main-agent
    assistantOverrides:
      metadata:
        position:
          x: 250
          y: 100
      tools:append:
        - type: handoff
          async: false
          function:
            name: handoff_to_EverBlue_Estimate_Agent
            parameters:
              type: object
              required:
                - contactName
                - contactPhone
                - addressUuid
              properties:
                addressUuid:
                  type: string
                  description: The Roofr addressUuid obtained from resolve_address tool (UUID v7 format, e.g., "172631c8-8230-4de0-8c83-92d07d5014f7")
                contactName:
                  type: string
                  description: Caller's name as collected during intake
                contactPhone:
                  type: string
                  description: Caller's phone number in E.164 format (e.g., "+12065551234")
            description: |-
              Silent handoff to Estimate Agent after:
              1. Caller confirmed this is a NEW project
              2. Collected name, phone, and address
              3. Address verified with resolve_address tool

              You MUST pass all collected information as parameters.
              IMPORTANT: addressUuid is a UUID string - pass it exactly as received, do not parse as number.
          messages: []
          destinations:
            - type: assistant
              description: Silent handoff to Estimate Agent with caller info
              assistantName: EverBlue - Estimate Agent
  - assistantId: everblue-estimate-agent
    assistantOverrides:
      metadata:
        position:
          x: 650
          y: 100
      tools:append:
        - type: handoff
          async: false
          function:
            name: handoff_to_EverBlue_Main_Agent
            description: Silent handoff back to Main Agent only if caller has complex questions that require knowledge base lookup. For simple questions (hours, areas, website), answer directly.
          messages: []
          destinations:
            - type: assistant
              description: Silent handoff back to Main Agent only if caller has complex questions that require knowledge base lookup. For simple questions (hours, areas, website), answer directly.
              assistantName: EverBlue - Main Agent
name: EverBlue Voice Squad (Flux)
membersOverrides:
  transcriber:
    model: flux-general-en
    language: en
    numerals: true
    provider: deepgram
    confidenceThreshold: 0.5
  observabilityPlan:
    tags:
      - Roofr
      - squad-v3
      - Flux
    provider: langfuse
  hooks:
    - do:
        - type: say
          exact: I'm sorry, I didn't quite catch that. Could you please repeat?
      on: assistant.transcriber.endpointedSpeechLowConfidence
      options:
        confidenceMin: 0.2
        confidenceMax: 0.49
    - do:
        - type: say
          exact: I'll be ending the call now. Please feel free to call back anytime. Have a great day!
        - tool:
            type: endCall
          type: tool
      on: customer.speech.timeout
      options:
        timeoutSeconds: 90
